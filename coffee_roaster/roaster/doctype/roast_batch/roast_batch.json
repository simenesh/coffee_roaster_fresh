{
  "doctype": "DocType",
  "name": "Roast Batch",
  "module": "roaster",
  "engine": "InnoDB",
  "custom": 0,
  "allow_rename": 1,
  "autoname": "format:RB-{roast_date}--{#####}",
  "field_order": [
    "roast_date",
    "company",
    "roast_profile",
    "operator",
    "roasting_machine",

    "source_details_section",
    "green_bean_item",
    "source_warehouse",
    "qty_to_roast",

    "target_details_section",
    "roasted_item",
    "target_warehouse",
    "output_qty",
    "batch_no",
    "column_break_1",

    "roast_phases_section",
    "charge_start",
    "charge_end",
    "charge_temp",
    "drying_end",
    "maillard_end",
    "development_end",

    "roast_cylinder",
    "cylinder_capacity_kg",
    "rounds_section",
    "generate_rounds",
    "rounds",
    "column_break_tot",
    "total_input_qty",
    "total_output_qty",
    "total_loss_qty",
    "total_quacker",
    "rounds_count",

    "results_section",
    "weight_loss_percentage",
    "qc_score",
    "notes"
  ],
  "fields": [
    { "fieldname": "roast_date", "fieldtype": "Date", "label": "Roast Date", "reqd": 1 },
    { "fieldname": "company", "fieldtype": "Link", "label": "Company", "options": "Company", "reqd": 1 },

    { "fieldname": "roast_profile", "fieldtype": "Link", "label": "Roast Profile", "options": "Roast Profile", "reqd": 1 },
    { "fieldname": "operator", "fieldtype": "Link", "label": "Roasting Operator", "options": "User" },
    { "fieldname": "roasting_machine", "fieldtype": "Link", "label": "Roasting Machine", "options": "Roasting Machine" },

    { "fieldname": "source_details_section", "fieldtype": "Section Break", "label": "Source Green Beans" },
    { "fieldname": "green_bean_item", "fieldtype": "Link", "label": "Green Bean Item", "options": "Item", "reqd": 1 },
    { "fieldname": "source_warehouse", "fieldtype": "Link", "label": "Source Warehouse", "options": "Warehouse", "reqd": 1 },
    { "fieldname": "qty_to_roast", "fieldtype": "Float", "label": "Input Weight (kg)", "reqd": 1 },

    { "fieldname": "target_details_section", "fieldtype": "Section Break", "label": "Roasted Coffee Output" },
    { "fieldname": "roasted_item", "fieldtype": "Link", "label": "Roasted Item (Finished Good)", "options": "Item", "reqd": 1 },
    { "fieldname": "target_warehouse", "fieldtype": "Link", "label": "Target Warehouse", "options": "Warehouse", "reqd": 1 },
    { "fieldname": "output_qty", "fieldtype": "Float", "label": "Output Weight (kg)" },
    { "fieldname": "batch_no", "fieldtype": "Link", "label": "Roasted Coffee Batch No", "options": "Batch", "read_only": 1 },
    { "fieldname": "column_break_1", "fieldtype": "Column Break" },

    { "fieldname": "roast_phases_section", "fieldtype": "Section Break", "label": "Roast Phases" },
    { "fieldname": "charge_start", "fieldtype": "Datetime", "label": "Charge Start Time" },
    { "fieldname": "charge_end", "fieldtype": "Datetime", "label": "Charge End Time" },
    { "fieldname": "charge_temp", "fieldtype": "Float", "label": "Charge Temp (Â°C)" },
    { "fieldname": "drying_end", "fieldtype": "Datetime", "label": "Drying End Time ('Yellowing')" },
    { "fieldname": "maillard_end", "fieldtype": "Datetime", "label": "Maillard End Time ('First Crack')" },
    { "fieldname": "development_end", "fieldtype": "Datetime", "label": "Development End Time ('Drop')" },

    { "fieldname": "roast_cylinder", "fieldtype": "Link", "label": "Roast Cylinder", "options": "Roast Cylinder", "reqd": 1 },
    { "fieldname": "cylinder_capacity_kg", "fieldtype": "Float", "label": "Cylinder Capacity (kg)", "read_only": 1, "fetch_from": "roast_cylinder.capacity_kg", "fetch_if_empty": 1 }, 

    { "fieldname": "rounds_section", "fieldtype": "Section Break", "label": "Rounds" },
    { "fieldname": "generate_rounds", "fieldtype": "Button", "label": "Add Round" },
    { "fieldname": "rounds", "fieldtype": "Table", "label": "Rounds", "options": "Roast Batch Round", "in_place_edit": 1 },

    { "fieldname": "column_break_tot", "fieldtype": "Column Break" },
    { "fieldname": "total_input_qty", "fieldtype": "Float", "label": "Total Input (kg)", "read_only": 1 },
    { "fieldname": "total_output_qty", "fieldtype": "Float", "label": "Total Output (kg)", "read_only": 1 },
    { "fieldname": "total_loss_qty", "fieldtype": "Float", "label": "Total Loss (kg)", "read_only": 1 },
    { "fieldname": "total_quacker", "fieldtype": "Float", "label": "Total Quacker (kg)", "read_only": 1 },
    { "fieldname": "rounds_count", "fieldtype": "Int", "label": "Rounds Count", "read_only": 1 },

    { "fieldname": "results_section", "fieldtype": "Section Break", "label": "Results & Quality Control" },
    { "fieldname": "weight_loss_percentage", "fieldtype": "Percent", "label": "Weight Loss (%)", "read_only": 1 },
    { "fieldname": "qc_score", "fieldtype": "Int", "label": "QC Score (Cupping)" },
    { "fieldname": "notes", "fieldtype": "Small Text", "label": "Notes" }
  ],
  "permissions": [
    { "role": "System Manager", "read": 1, "write": 1, "create": 1, "delete": 1, "submit": 1, "email": 1, "export": 1, "print": 1, "report": 1, "share": 1, "cancel": 1 },
    { "role": "Roasting Operator", "read": 1, "write": 1, "create": 1 },
    { "role": "Roasting Manager", "read": 1, "write": 1, "create": 1, "submit": 1 },
    { "role": "QC Officer", "read": 1, "write": 1 }
  ],
  "sort_field": "modified",
  "sort_order": "DESC",
  "track_changes": 1
}
